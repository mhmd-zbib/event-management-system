flowchart TD
%% Request Entry
    Start([New Venue Request]) -->|User: mhmd-zbib| RequestValidation

%% Initial Validation
    subgraph Validation [Request Validation]
        RequestValidation{Validate Request} -->|Valid| StartTX[Start Transaction]
        RequestValidation -->|Invalid| Error400[Return 400]

        StartTX --> ValidateS3{Validate S3 Links}
        ValidateS3 -->|Invalid| Error422[Return 422: Invalid Images]
        ValidateS3 -->|Valid| ProcessVenue
    end

%% Core Venue Processing
    subgraph VenueCreation [Venue Setup]
        ProcessVenue[Process Venue Data] --> SaveVenue[Save Venue Details]
        SaveVenue --> SaveImages[Save Image References]
        SaveImages --> SaveAmenities[Save Amenities]
        SaveAmenities --> SaveLocation[Save Location]
    end

%% Booking Settings
    subgraph BookingSetup [Booking Configuration]
        SaveLocation --> SetupBooking[Setup Booking Rules]
        SetupBooking --> SavePricing[Save Pricing]
        SavePricing --> SaveAvailability[Save Available Dates]
    end

%% Transaction Completion
    BookingSetup --> FinalCheck{All Success?}
    FinalCheck -->|No| RollbackTX[Rollback Transaction]
    FinalCheck -->|Yes| CommitTX[Commit Transaction]

%% Post Processing
    CommitTX --> IndexVenue[Index for Search]
    IndexVenue --> NotifyUser[Notify User]

%% Response Handling
    RollbackTX --> ErrorResponse[Return Error]
    NotifyUser --> SuccessResponse[Return Success]

%% Database Schema Hints
    subgraph DBSchema [Database Tables]
        direction LR
        Venues[(Venues)]
        VenueImages[(Venue_Images)]
        VenueAmenities[(Venue_Amenities)]
        BookingRules[(Booking_Rules)]
        Availability[(Availability)]
    end

%% Metadata
    subgraph Meta [Request Metadata]
        direction LR
        Created[Created: 2025-02-02 19:17:06]
        Author[Author: mhmd-zbib]
    end

%% Styling
    classDef primary fill:#e3f2fd,stroke:#1565c0,stroke-width:2px
    classDef secondary fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#f57c00,stroke-width:2px
    classDef success fill:#e8f5e9,stroke:#2e7d32,stroke-width:2px
    classDef error fill:#ffebee,stroke:#c62828,stroke-width:2px
    classDef db fill:#f5f5f5,stroke:#424242,stroke-width:2px

    class Start,CommitTX success
    class ProcessVenue,SetupBooking primary
    class RequestValidation,ValidateS3,FinalCheck decision
    class Error400,Error422,RollbackTX error
    class Venues,VenueImages,VenueAmenities,BookingRules,Availability db